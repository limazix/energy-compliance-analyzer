@startuml
!define GCPPuml https://raw.githubusercontent.com/Crashedmind/PlantUML-icons-GCP/master/dist
!include GCPPuml/GCPC4Integration.puml

' To use specific GCP icons as sprites, you'll need to include their definition files, e.g.:
' !include GCPPuml/Firebase/Firebase.puml
' !include GCPPuml/GoogleCloud/GoogleCloudPlatform.puml
' !include GCPPuml/AI/VertexAI.puml ' For Gemini if represented as Vertex AI service

title System Context Detail - Energy Compliance Analyzer

Person(user, "User", "Electrical Sector Professional")

System_Boundary(gcp_boundary, "Google Cloud Platform") {
    SystemDb_Ext(firebase_auth, "Firebase Authentication", "Firebase", "Handles user authentication via Google Sign-In")
    SystemDb_Ext(firestore, "Firebase Firestore", "Firebase", "Stores analysis metadata, status, and structured reports")
    SystemDb_Ext(storage, "Firebase Storage", "Firebase", "Stores uploaded CSVs and generated MDX reports")
    SystemDb_Ext(rtdb, "Firebase Realtime DB", "Firebase", "Stores chat history for report interaction")
    System_Ext(functions, "Firebase Functions", "Firebase", "Executes background AI processing pipeline")
    System_Ext(app_hosting, "Firebase App Hosting", "Firebase", "Hosts the Next.js Frontend Web App")
    System_Ext(gemini, "Google AI (Gemini)", "Google AI", "Provides LLM capabilities for analysis and chat")
}

System(eca, "Energy Compliance Analyzer", "SaaS application hosted on Firebase, utilizing GCP services for its backend, AI, and data persistence.")

Rel(user, eca, "Uploads CSV data, views reports, interacts via chat")

Rel_D(eca, firebase_auth, "Uses for User Login")
Rel_D(eca, firestore, "Stores/Retrieves Analysis Data")
Rel_D(eca, storage, "Stores/Retrieves Files")
Rel_D(eca, rtdb, "Manages Chat History")
Rel_D(eca, functions, "Triggers for Processing")
Rel_D(eca, app_hosting, "Hosted On")
Rel_D(eca, gemini, "Uses for AI tasks")

@enduml
