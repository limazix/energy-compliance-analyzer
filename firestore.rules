rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Restringe o acesso à coleção 'users'
    match /users/{userId}/{document=**} {
      // Permite leitura e escrita (incluindo criação, atualização, exclusão)
      // somente se o usuário estiver autenticado (request.auth != null)
      // E se o UID do usuário autenticado (request.auth.uid) for igual ao
      // {userId} no caminho do documento.
      // O {document=**} permite que esta regra se aplique a todos os documentos
      // e subcoleções dentro do documento do usuário específico.
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}